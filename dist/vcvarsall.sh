#!/bin/sh
set -e

#--------------------------------------------------------------------------------------------------
# Settings
#--------------------------------------------------------------------------------------------------

vcvars="/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/VC/Auxiliary/Build"

#--------------------------------------------------------------------------------------------------
# Syntax
#--------------------------------------------------------------------------------------------------

if [ $# != 1 ] || [ $1 != "win32-msvc" -a $1 != "win64-msvc" ]; then

    echo "Usage: vcvarsall <win32-msvc | win64-msvc>"

    exit 1
fi

#--------------------------------------------------------------------------------------------------
# Configuration
#--------------------------------------------------------------------------------------------------

if [ $1 = "win32" ]; then

    target="x86"
else
    target="x64"
fi

#--------------------------------------------------------------------------------------------------

MSVC="/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/VC/Tools/MSVC/14.25.28610/bin/HostX64/$target"

#--------------------------------------------------------------------------------------------------
# BuildTools
#--------------------------------------------------------------------------------------------------

cd "$vcvars"

if [ $1 = "win32-msvc" ]; then

    ./vcvarsall.bat x86
else
    ./vcvarsall.bat x64
fi

#--------------------------------------------------------------------------------------------------
# PATH
#--------------------------------------------------------------------------------------------------

PATH="$MSVC:$PATH"

printenv PATH
